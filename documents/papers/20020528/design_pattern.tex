%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  特殊文字 : 
%    改行 -> \\
% 
%  注釈 : 
%    \footnote[1]{ 注釈の内容 }
%           
%  次のページ :
%    \pagebreak
%
%  整形をせずにそのまま出力 :
%  (ソース等)
%    \begin{verbatim}  〜内容
%    \end{verbatim}
%
%  整形をせずにそのまま出力：
%  ( 枠を付ける )
%   まず、以下のパッケージを使う  
%   \usepackage{eclbkbox}
%   そのあとにソースを記述
%   \begin{breakbox}
%     \begin{verbatim}
%        ソース
%     \end{verbatim}
%   \end{breakbox}
%
%  箇条書 :
%    \begin{itemize}
%    \item\hspace*{5mm} 箇条書の内容
%    \end{itemize}
%   
%  画像を張り付ける
%    \begin{center}
%    \includegraphics{ 画像ファイル名.eps }
%    \end{center}
%
%  セクションの作成 :
%    \section{ 内容 }
%
%  サブセクションの作成 :
%    \subsection{ 内容 }
%
%--------------------------------------------------
%  番号の付いていないセクションも目次に出す:
%    \addcontentsline{toc}{section}{目次に出す名前}
%
%  [ 参考文献の場合 ]
%% (j)article クラスの場合
%%
%\begin{thebibliography}{99}
%\addcontentsline{toc}{section}{\refname}% 追加
%\bibitem{bibunsho4} 名前
%                   本の名前
%\end{thebibliography}
%
%% (j)report・(j)book クラスの場合
%% 
%\begin{thebibliography}{99}
%\addcontentsline{toc}{chapter}{\bibname}% 追加
%\bibitem{bibunsho4} 名前
%                   本の名前
%\end{thebibliography}
%-----------------------------------------------
%
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% * 概要の書き方
%    規定字数以内でその論文 の取り扱う範 囲，目的，内容
%   の要点および主な結論などを記述する

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% documentclass の宣言 % @ 書式
% \documentclass [ オプション ] { 書式 }
%
% [ オプションの種類 ]
% * 二段組
% [twocolumn]
% * 印字の大きさ
% [a4p]
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% レジュメに使うなら、jarticle
%
%\documentclass[twocolumn,a4p]{jarticle}

\documentclass[a4p, epsf]{jarticle}
\usepackage{multicol}
% 画像を張り付ける
\usepackage[dvips]{graphics}
% 行列が使えるパッケージ
\usepackage{amsmath}
% ソースに枠をつける
\usepackage{epsf}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 余白や文字間の幅の細かい設定
%
% 
%\setlength{\voffset}{65pt}
%\setlength{\topmargin}{-170pt}
%\setlength{\textheight}{770pt}
%\setlength{\oddsidemargin}{-10pt}
%\setlength{\textwidth}{480pt}
%\setlength{\headsep}{40pt}

% 文書のはじまり 
\begin{document}

%---------------------------------------------
%
% article の時の表紙を別ページにする
%
\vspace*{4cm}
\begin{center}
{\LARGE ソフトウェアに対するパタンについて \\} 
\vspace*{1cm}
{\large 01ca0125 鈴木 藍 \\ 
  2002年 5月 28日}
\end{center}
\thispagestyle{empty}
\newpage
%------------------------------------------------
%========================================
% ここから文章
%
% 1ページ目
%
%========================================

%----------------------------------------
%
% もくじをつける
\tableofcontents
\newpage
%----------------------------------------

% 概要 (abstract)
%
\begin{abstract} 
\addcontentsline{toc}{section}{概要}
オブジェクト指向に関するデザインパタンとそれに付随する
言葉を調べ、まとめた。また、GoF の 23 のデザインパタンに
ついて、使った事がありそうなパタンを調べた。

\end{abstract}

% はじめに
% section のオプションで、数字を表示させないようにする
%
\section*{レポートの目的}
\addcontentsline{toc}{section}{レポートの目的}
有名なデザインパタンについて調べ、それを知識として身につける。
また、オブジェクト指向という方法論について改めて振り返る。

%------------------------------------------------------
% セクション
%------------------------------------------------------
\section{ はじめに }
%------------------------------------------------------
\subsection{ レポートの内容 }
ソフトウェアに対するパタン、アーキテクチャについて調べたが、アーキテクチャの種類と
デザインパタンそのもの、 デザインパタンのカタログに触れたのは初めてだったので、文献の内容を
記憶する意味でほぼそのままをレポートにした。内容については
自分の考察などを適宜付け加えながらまとめてある。\\
デザインパタンはどのような言語、あるいはプログラミングにも
存在するものであるが、今回はオブジェクト指向プログラミング
を行う上で登場するパタンについて調べた。また、授業で触れた MVC についても
調べてみた。

%-------------------------------------------
\section{ オブジェクト指向設計 }
%-------------------------------------------
\subsection{ オブジェクト指向設計を行うために }
オブジェクト指向という方法論のメリットは「物」という人間的な認識の単位でソフトウェアを
構築できるところにある。現実世界にあるものを、計算機上で写像し実行させる事は
設計をする上でもとても有益なことであるが、実際計算機に必要とされている物は、
現実世界「そのもの」ではなく、現実世界をあらわして問題解決を行うソフトウェアという一種の
「機械」である。産業の中でのソフトウェア開発はこの「機械」の機構や これを構成する部品の
設計を戦略的に行う必要が有る。現在のソフトウェア開発における設計には、これらを効率良く
行うための設計手段が不可欠であると言える。

%-------------------------------------------
\section{ オブジェクト指向設計を行う上での基本的な概念 }
%-------------------------------------------
\subsection{ アーキテクチャ }
もともとは建築の用語で、建築物が作られる際にその建築がとるべき典型的な構造、
装飾を示すものである。さらにソフトウェアの世界では、単にソフトウェアの典型的構造にのみ焦点を当てている
わけではなく、その振る舞いについても規定しており、どのようなデータが流れ、
どのようにプロセスが起動し、どのモジュールが処理を行っていくのかという、典型的な振る舞いの規定
を定める事によってシステムは信頼できるものになる。

\subsection{ フレームワーク }
\subsubsection{ フレームワークとは }
フレームワークは、アーキテクチャにくらべ、実際の具体物が存在するという点でより明確にとらえることが出来る。
通常は、「特定のアーキテクチャに基づき、実装された半完成のシステム」を指し、「アーキテクチャの実例」
とも言う事が出来る。

\subsubsection{ フレームワークの具体的な意味 }
アーキテクチャに基づいてソフトウェアを作る際に、一からすべてを構築していったのでは非常に
時間がかかるので、特定のアーキテクチャに基づいて実装されたできあいの半完成システムに対し、プラグインとして
作成した(またはどこからか入手した)特定のソフトウェア部品をはめ込むことで、望みのシステムを手速く、安定したもの
として作ることが出来る。フレームワークの代表例としてはMVCライブラリや、最近ではAppletの仕組みも一種の
フレームワークと言う事が出来、開発者はAppletのサブクラスを作成(もしくは入手)するだけで、WWWブラウザを通じ、
サーバから動的にAppletを受け取ってクライアントとして実行させていくことが可能になる。\\

\subsubsection{ フローズンスポットとホットスポット }
フレームワークを設計する上で重要なことは、どの部分をプラグインできるようにし、どの部分を出来合いのものとして
固定化するかということにあり、この選択を間違えると手の込んだだけの使えないフレームワークになってしまう。
メタパターン(フレームワークを構成するためのデザインパターン)を定義したWolfgang Preeは、
フローズンスポットとホットスポットという言葉で、このことを表現ており、フレームワークを作成する際にドメイン分析
の結果、固定化しており、今後の変更が起こらないと思われる部分は、強固な流れを規定するフローズンスポットとなり、
一方で新たな要求の発生が予想され、その変更に対し柔軟に対処できるようプラグを用意した部分がホットスポットであると
定義している。\\
しかし、ソフトウェア開発を行う上で、
どの部分がフローズンスポットであり、どの部分がホットスポットであるかの区別は自動的にできるものではなく、
この分割を行っていくには、開発者側の都合を考えただけでは不完全であり、ユーザから得るアプリケーションの
ドメインに関する知識が不可欠である。ユーザの要求の中で変化しやすい部分とそうでない部分を見定めて「分けていく」
ことが「分析」という作業になる。

\subsection{ デザインパタン }
フレームワークのホットスポットとフローズンスポットにおいて、変化しやすい部分をホットスポットとして
実装コードの中に適切に表現していくには、単に分析ができているだけでは不十分である。
実際にフローズンスポット、ホットスポットをコードとして組み上げていくにはそのための道具が必要になり、
その道具がデザインパタンである。

%-------------------------------------------
\section{ アーキテクチャの例 }
%-------------------------------------------
\subsection{ MVC とは }
MVCは、対話型のアプリケーションを作成するためのアーキテクチャである。Smalltalkやその派生などの環境が、
このMVCと呼ばれるアーキテクチャを用い、高度なGUIを実現している。\\
\subsection{ MVC の意味 }
MVCはそれぞれ、Model、View、Controllerを意味しており、Smalltalkなどの環境であれば、
M はコンピュータが扱うデータ(一種のModel)、V はディスプレイ(一種のView)、
C はマウス(一種のController)という様に分ける事が出来る。\\
また、MVCでは、対話的なアプリケーションを実現するため、アプリケーションの構成要素を、
処理、表示、入力の3つ組みに分割することに決めており、この分割がMVCアーキテクチャの
基本的な構造を規定している。\\
Modelの状態を表示する部分はViewとなり、ディスプレイ上に表示されるウィンドウや、その中のウィジェット群
がViewの候補になる。
Controllerは、マウスやキーボードからの入力をイベントとして受け取る役割を受け持ち、OSからのマウスやキーボードの
クリックといったプリミティブなイベントの中から、自分に関係のあるものを選択、処理し、適切な形に変換してモデルに
伝達する。

\subsection{ それぞれの役割 }
以下はModel-View-Controllerの3つ組みの関係を表した図である。
\begin{center}
\includegraphics{MVC.eps}
\end{center}
Controllerが、OSからイベントを受け取り、Modelにメッセージを送り、Modelの状態を更新する。Modelの状態変化
はViewに通知され、通知されたViewは、Modelの最新の値を取得し、再表示を行うという流れが基本的になる。
3つ組は、それぞれ独立しているのが望ましく、特にモデルとビューの切り離しは非常に重要であり、「ViewやControllerは
Modelを知っているが、Modelはその他の要素については何も知らない」という状態になるのが理想とされている。

%-------------------------------------------
\section{ デザインパタン }
%-------------------------------------------
\subsection{ デザインパタンとは }
デザインパターンは、もともとフレームワークの作成過程の中でなるべくソフトウェアを再利用性が高く、
効率も良く、また柔軟なものとしたいという開発者の要求から、自然発生的に生じてきたものである。
実装としてのフレームワークは、特定の言語によるクラス定義とその関連から構成されており、これには
繰り返し特定のパタンが現れて出ている。

\subsection{ デザインパタンの成立ち }
80年代の後半ごろから、このパタンを精製して整理することで、後のフレームワーク作りの構築要素として
役立てることができるのではないかと設計者は徐々に気づき始めた。
1987年、OOPSLAというオブジェクト指向に関するカンファレンスで、Kent Beck、Ward Cunninghamの二人によって
"Using Pattern Languages for Object-Oriented Programs"という記念的な論文が発表される。
この論文は、建築家である、Christopher Alexanderが、クライアントの要求にかなった建築を作り出す
ために抽出した「パタン」の考えをソフトウェアにも応用できるのではと示唆したものであった。

\subsection{ パタンという考え方 }
Alexanderは、「パタン」という建築の過程で生じてくる様々な問題や、それに対する典型的な解決の方法を、
誰もがわかりやすいパタンとし、カタログ化して示すことにより、設計者が自由にパタンを選択して、より要求にかなった
建築の手がかりとしていくという考え方を提唱した。
ソフトウェアも、要求をかなえるための成果物を構築しなければならないという点において、建築の世界と非常に似た部分がある。
Kent BeckとWard Cunninghamは、GUIの構築について幾つかの「パタン」をカタログ化して提示することで、MVCの全てを
理解しなくても、一定の基準を維持したアプリケーションを作成できるのではないかと主張した。

\subsection{ パタンの種類 }
パターンは、扱う問題のスケールや種類によっていくつかに分類できる。 \\
・ アーキテクチャパタン \\
・ デザインパタン \\
・ イディオム 
\subsubsection{ アーキテクチャパタン }
アーキテクチャパターンは、システム全体を支配するような大きな問題解決のために特定のアーキテクチャの適用方法
を説明したものである。MVCなどが例にあがる。

\subsubsection{ デザインパタン }
デザインパタンは、クラス間の関係や相互作用について示したものであり、フレームワークの構築要素として役立つ。

\subsubsection{ イディオム }
特定のオブジェクト指向で有効な実装のルールやスタイルをパタンとして扱ったものである。意味としては
「慣用句」や、個人語で何度も現れるパタンなどにあたる。

\subsection{ 現在のデザインパタン }
GoF (Gang of Four) - Erich Gammma, Richard Helm, Ralph Johnson, John Vlissidesら四人による
"Design Pattern: Elements of Reusable Object-Oriented Software" において、23 のデザインパタンが提唱されている。 
しかし、現在はこれらに限らず企業などが独自に考案したパタンも公開されている。

%-------------------------------------------
\section{ 23 種のデザインパタン }
%-------------------------------------------
今回は、生成 、 構造 、 振る舞い 、 に含まれる23 のデザインパタンを見て、Java でプログラミングを
した時に遭遇したと思われるものを調べた。
Abstract Factory  から  Chain of Responsibility までは
実際に遭遇したと思われるが、それ以降は興味深いパタンだったので
調べてみた。
また、実際の実装に関しての記述は、言語に依存した内容になってしまうので
省いてある。

\subsection{ Abstract Factory }
実装に依存する部分を意識せずに、複数の部品群を生成するためのパタン。
上位クラスではインスタンスを生成せず、実際にオブジェクトを作るのはサブクラスになる。
今の所、Template Method と Factory Method との見分けが付いていない。

\subsection{ Factory Method }
インスタンス作成をサブクラスにまかせて抽象クラスを生成するパタン。
抽象クラスはインスタンス化されるサブクラスを事前に想定していない。
学校の OOP の授業で C++ を教わっているが、メンバ関数 に virtual 
という宣言をすることで いずれかのインスタンスがオーバーライドすることを
想定している。どのようなインスタンスかは想定していないので、この部分は
Factory Method になると思うが、これも Template Method と見分けがつかない。

\subsection{ Template Method }
基本的な振る舞いの記述は抽象クラスにテンプレートとして定義し、目的によって内容の記述を変えなければ
ならない部分をサブクラスで定義する。Java などのオブジェクト指向言語では
当り前のように使われていると思う。パタンとして上がっているのを見て
改めて認識した。

\subsection{ Mediator }
Webの文献によって記述が違っていたが、判断ロジックをオブジェクトに集中させたり
あるオブジェクトに複数のオブジェクトの関連を記述するパタン。
普段から行っている方法に思える。

\subsection{ Prototype }
インスタンスから、さらにインスタンスを生成するパタン。
Java で プログラムを書いていた時はあまり良い方法だとは
思っていなかったが、普通に行われているようである。
よく見ると自分自身をそのままの状態で生成しているが、
なかなかこの風景が興味深い。

\subsection{ State }
状態遷移のためのパタン。個々の状態をクラスとして表す。
また、状態をサブクラス毎に記述するため、コードの可読性が高まるだけでなく状態の追加も容易になる。
クラスそのものを状態として表した事はないが、クラスの属性の値を状態として、その状態を
返すメソッドを作成することを普通にしている。わざわざクラスで状態を表す状況がまだわからない。

\subsection{ Chain of Responsibility }
オブジェクトを数珠つなぎにし、あるメッセージを解釈できるオブジェクトに突き当たるまで、そのメッセージを
横流しにするパタン。 複雑な switch 文を記述せずに、解釈できるオブジェクトにあたった時にはそのなかに
処理を記述し、可読性を上げる事が出来る。

\subsection{ Interpreter }
言語の文法表現を解釈するためのオブジェクト構成を提供するパタン。
問題解決のために新たな言語を作る。
今回みた中で一番興味深いパタンである。このような事が
23 個の中の一つにあげられていることがとても意外だった。

\subsection{ Observer }
複数の関連し合うオブジェクトの状態の一貫性を保つためのパタン。
状態の基準となるオブジェクトをSubjectと呼び、Subjectと関連をもつオブジェクトをObserverと呼ぶ。
1人のSubjectを多数のObserverたちが監視するので、通常Observerは複数になる。
一つのObserverに変化があると、Subjectへ通知し、Subjectは、その変化を関連する全てのObserverへ通知する。
クライアント(Observer)がサーバ(Subject)に通知をしている形が クライアントサーバの様に思える。

%-------------------------------------------
\section{ これからのデザインパタンへの取り組み方 }
%-------------------------------------------
今回、デザインパタンを調べた上で、自分がこれからデザインパタンに
どう取り組むかをまとめた。

\subsection{ デザインパタンを見て }
23 種の中で、いくつかは以前に見た事があるような形をしていたが
それ以外のパタンについては、そのパタンの使われる状況の
予測がしにくかった。また、これらを覚えるだけでは身につかないことは
分かった。

\subsection{ どのように学習してゆくか }
まず、すべてのパタンの枠組を一通り簡単に覚えておくことが
大切だと思った。もし、ある問題に遭遇した時に、
使えるパタンをすぐに出せる様な状況にしておけば
これらが活用できると思う。ただ、使うだけではなく、実際に
自分で考えて本当にそれが適切であるかどうかを見定める事も
忘れてはいけないと思った。

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  感想、展望
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{まとめ・結論}
\addcontentsline{toc}{section}{まとめ・結論}
デザインパタンを学習する事は、自分のもっとも良い言い回し(イディオム)
に早く気が付くための近道であると思った。また、これまで
多くの技術者が培った知識や経験を使う事は
よい作法を身につける近道でもあると思う。

%------------------------------------------------
\section*{感想} 
\addcontentsline{toc}{section}{感想}
初めてデザインパタンについて調べてみたが、意外なパタン
についての記述も多かった。Web で Smalltalker 以外のデザインパタン
の文献はどれを参考にしたら良いかよくわからなかったので
Happy Squeaking!! の引用がほとんどになったが、デザインパタンの
本を書いているサイトも参考にしてみた。パタンについては
まだ一通り覚えるだけにして、しばらくは(学生の間だけは)車輪の再開発を続けたいと
思う。

\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  参考文献
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% 「関連図書」を変更する
% jreport, jbook なら、bibname
%\renewcommand{\bibname}{変更後の名前}
%\renewcommand{\bibname}{参考文献}

% 「参考文献」を変更する
% jarticle なら、refname
\renewcommand{\refname}{参考文献}
\begin{thebibliography}{9}

% 目次に参考文献をいれる
\addcontentsline{toc}{section}{\refname}% 追加

% 参考文献
\bibitem{ hoge  }
 Smalltalk イディオム \\
 青木 淳 著 \\
 1997年 2 月25 日 (第1版)

\bibitem{ piyo  }
 Happy Squeaking!! \\
 http://www.ogis-ri.co.jp/otc/hiroba/technical/Squeak/  \\
 2002年 5月 27日 参照

\bibitem{ sage }
 UML 入門 \\
 山田 正樹 著  \\
 2002 年 3 月 11 日 初版

\bibitem{ mona  }
 Java言語で学ぶデザインパターン入門  \\
 http://www.hyuki.com/dp/ \\
 2002年 5月 27日 参照

\bibitem{ gigo  }
 Skelton of GOF's Design Pattern  \\
 http://www11.u-page.so-net.ne.jp/tk9/ys\_oota/mdp/ \\
 2002年 5月 27日 参照

\bibitem{ age  }
 デザインパターンの活用について \\
 http://www.dmz.hitachi-sk.co.jp/Java/Tech/pattern/apply.html \\
 2002年 5月 27日 参照
\end{thebibliography}

% 文書の終了
\end{document} 
